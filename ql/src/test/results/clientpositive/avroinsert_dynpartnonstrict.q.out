PREHOOK: query: drop table if exists t1
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table if exists t1
POSTHOOK: type: DROPTABLE
PREHOOK: query: drop table if exists t2_avro
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table if exists t2_avro
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table t1 (c1 bigint, c2 string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
POSTHOOK: query: create table t1 (c1 bigint, c2 string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t1
PREHOOK: query: CREATE TABLE t2_avro
PARTITIONED BY (p1 string)
ROW FORMAT SERDE 
  'org.apache.hadoop.hive.serde2.avro.AvroSerDe' 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'
TBLPROPERTIES(
'avro.schema.literal'='{
"namespace": "testing.hive.avro.serde",
"name": "test",
"type": "record",
"fields": [
{ "name":"c1", "type":"int" },
{ "name":"c2", "type":"string" }
]}')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
POSTHOOK: query: CREATE TABLE t2_avro
PARTITIONED BY (p1 string)
ROW FORMAT SERDE 
  'org.apache.hadoop.hive.serde2.avro.AvroSerDe' 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'
TBLPROPERTIES(
'avro.schema.literal'='{
"namespace": "testing.hive.avro.serde",
"name": "test",
"type": "record",
"fields": [
{ "name":"c1", "type":"int" },
{ "name":"c2", "type":"string" }
]}')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t2_avro
PREHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: load data local inpath '../../data/files/avrotest.dat' into table t1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: insert overwrite table t2_avro partition(p1) select *,c1 as p1 from t1 distribute by p1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: default@t2_avro
POSTHOOK: query: insert overwrite table t2_avro partition(p1) select *,c1 as p1 from t1 distribute by p1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: default@t2_avro@p1=1
POSTHOOK: Output: default@t2_avro@p1=2
POSTHOOK: Output: default@t2_avro@p1=3
POSTHOOK: Output: default@t2_avro@p1=4
POSTHOOK: Output: default@t2_avro@p1=5
POSTHOOK: Lineage: t2_avro PARTITION(p1=1).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=1).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=2).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=2).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=3).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=3).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=4).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=4).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=5).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=5).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
PREHOOK: query: select count (*) from t2_avro
PREHOOK: type: QUERY
PREHOOK: Input: default@t2_avro
PREHOOK: Input: default@t2_avro@p1=1
PREHOOK: Input: default@t2_avro@p1=2
PREHOOK: Input: default@t2_avro@p1=3
PREHOOK: Input: default@t2_avro@p1=4
PREHOOK: Input: default@t2_avro@p1=5
#### A masked pattern was here ####
POSTHOOK: query: select count (*) from t2_avro
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t2_avro
POSTHOOK: Input: default@t2_avro@p1=1
POSTHOOK: Input: default@t2_avro@p1=2
POSTHOOK: Input: default@t2_avro@p1=3
POSTHOOK: Input: default@t2_avro@p1=4
POSTHOOK: Input: default@t2_avro@p1=5
#### A masked pattern was here ####
POSTHOOK: Lineage: t2_avro PARTITION(p1=1).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=1).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=2).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=2).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=3).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=3).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=4).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=4).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=5).c1 EXPRESSION [(t1)t1.FieldSchema(name:c1, type:bigint, comment:null), ]
POSTHOOK: Lineage: t2_avro PARTITION(p1=5).c2 SIMPLE [(t1)t1.FieldSchema(name:c2, type:string, comment:null), ]
25
